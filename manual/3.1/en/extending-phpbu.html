<!DOCTYPE html>
<html lang="en">
<head>
  <title>PHPBU Manual &#8211; Chapter 10. Extending PHPBU</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="canonical" href="http://phpbu.de/manual/current/en/extending-phpbu.html">
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/highlight.min.css" rel="stylesheet">
  <link href="css/phpbu.css" rel="stylesheet">
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
 </head>
 <body>

  <nav class="navbar navbar-inverse navbar-static-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed"
                data-toggle="collapse" data-target="#navbar" aria-expanded="false"
                aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">
          <svg xmlns="http://www.w3.org/2000/svg"height="25" title="phpbu - php backup utility"
               viewBox="0 43 140 40">
            <path d="M31.8 43C31.2 43 30.7 43.2 30.3 43.6 30 44 29.8 44.5 29.8 45.1L29.8 72.4C29.8 72.9
                  30 73.4 30.3 73.8 30.8 74.2 31.2 74.4 31.8 74.4 32.4 74.4 32.9 74.2 33.3 73.8 33.7
                  73.4 33.9 72.9 33.9 72.4L33.9 62.7C33.9
                  61.9 34 61.1 34.3 60.3 34.7 59.6 35.1 58.9 35.7 58.4 36.2 57.8 36.9 57.4 37.6 57.1 38.4
                  56.7 39.1 56.6 40 56.6 40.8 56.6 41.6 56.7 42.4 57.1 43.1 57.4 43.8 57.8 44.3 58.4
                  44.9 58.9 45.3 59.6 45.7
                  60.3 46 61.1 46.2 61.9 46.2 62.7L46.2 72.4C46.2 72.9 46.4 73.4 46.7 73.8 47.2 74.2 47.6
                  74.4 48.2 74.4 48.8 74.4 49.2 74.2 49.6 73.8 50 73.4 50.2 72.9 50.3 72.4L50.3
                  62.7C50.3 61.3 50 60 49.4 58.7 48.9 57.5 48.1
                  56.4 47.2 55.5 46.3 54.5 45.2 53.8 43.9 53.3 42.7 52.7 41.4 52.5 40 52.5 37.6 52.5 35.6
                  53.1 33.9 54.5L33.9 45.1C33.8 44.5 33.6 44 33.2 43.6 32.8 43.2 32.4
                  43 31.8 43L31.8 43zM80.6 43C80 43 79.5 43.2 79.1 43.6 78.8 44 78.6 44.5 78.6 45L78.6
                  63.4C78.6 64.9 78.8 66.2 79.3 67.5L80.3 63.7 82.8 64.8C82.7 64.4 82.7 63.9 82.7 63.4
                  82.7 62.5 82.8 61.6 83.2 60.8 83.6 59.9 84
                  59.2 84.7 58.6 85.3 58 86 57.5 86.8 57.1 87.7 56.7 88.6 56.5 89.6 56.5 90.5 56.5 91.4
                  56.7 92.2 57.1 92.9 57.4 93.4 57.7 93.9 58.1L91.2 59.7 95 61.1 98.9 62.5 99.7 58.4 100.5
                  54.4 97.7 56C97.6
                  55.9 97.4 55.8 97.3 55.7 95.2 53.5 92.6 52.4 89.6 52.4
                  86.9 52.4 84.6 53.3 82.7 54.9L82.7 45.1C82.7 44.5 82.5 44 82.1 43.6 81.7 43.2 81.2 43
                  80.6 43L80.6 43zM15.7 52.4L15.7 52.4C12.7 52.4 10.1 53.5 7.9 55.6 6.2 57.4 5.2 59.4 4.8
                  61.8L1.7 61.8 1.7 61.8 1.6 61.8 4.3 64.9
                  7 68.1 9.7 64.9 12.4 61.8 12.3 61.8 12.4 61.8 9 61.8C9.1 61.4 9.2 61.1 9.3 60.8 9.7
                  59.9 10.2 59.2 10.8 58.6 11.4 57.9 12.1 57.4 13 57.1
                  13.8 56.7 14.7 56.5 15.7 56.5 16.6 56.5 17.5 56.7 18.4
                  57.1 19.2 57.4 19.9 57.9 20.6 58.6 21.2 59.2 21.7 59.9 22 60.8 22.4 61.6 22.6 62.5 22.6
                  63.4 22.6 64.4 22.4 65.2 22 66.1 21.7 66.9 21.2 67.6 20.6 68.3 19.9 68.9 19.2 69.4 18.4
                  69.8 17.5 70.1 16.6 70.3 15.7 70.3 14.7 70.3 13.8 70.1 13 69.8 12.1 69.4 11.4 68.9 10.8
                  68.3 10.3 67.7 9.8 67.1 9.5 66.4L7 69.3 4.7 66.5 4.7
                  81.8C4.7 82.4 4.9 82.8 5.3 83.2 5.7 83.6 6.1 83.8
                  6.7 83.8 7.3 83.8 7.8 83.6 8.2 83.2 8.6 82.8 8.8 82.4 8.8 81.8L8.8 72C10.7 73.6 13 74.4
                  15.7 74.4 17.2 74.4 18.6 74.1 19.9 73.6 21.2 73.1 22.3 72.2 23.4 71.2 25.6 69 26.7 66.5
                  26.7 63.4 26.7 61.9 26.4 60.5 25.9
                  59.2 25.3 57.9 24.5 56.7 23.5 55.6 21.3 53.5 18.7 52.4 15.7 52.4zM64.5 52.4C61.5 52.4
                  58.9 53.5 56.7 55.6 54.6 57.8 53.5 60.4 53.5 63.4L53.5 81.8C53.5 82.4 53.7 82.9 54.1 83.3
                  54.5 83.7 55 83.8 55.5 83.8 56.1 83.8
                  56.6 83.7 57 83.3 57.4 82.9 57.6 82.4 57.6 81.8L57.6 72C59.6 73.6 61.9 74.4 64.5 74.4
                  66 74.4 67.4 74.2 68.7 73.6 70 73.1 71.2 72.3 72.3 71.2 74.4 69.1 75.5 66.5 75.5 63.4
                  75.5 61.9 75.2 60.5 74.7
                  59.2 74.1 57.9 73.3 56.7 72.3 55.7 70.1 53.5 67.5 52.4 64.5 52.4L64.5 52.4zM105.8
                  52.4C105.2 52.4 104.7 52.6 104.3 53 103.9 53.4 103.7 53.9 103.7 54.5L103.7 64.2C103.7
                  65.6 104 66.9 104.5 68.1 105.1 69.4 105.8 70.5
                  106.8 71.4 107.7 72.3 108.8 73.1 110 73.6 111.3 74.1 112.6 74.4 114 74.4 115.2 74.4
                  116.3 74.3 117.3 73.9 118.3 73.6 119.2 73.1 120.1 72.4 120.2 73
                  120.4 73.4 120.7 73.8 121.1 74.2 121.6 74.4 122.2 74.4 122.8 74.4 123.2 74.2 123.6
                  73.8 124 73.4 124.2 72.9 124.2 72.4L124.2 54.5C124.2 53.9 124 53.4 123.6 53 123.2 52.6
                  122.8 52.4 122.2 52.4 121.6 52.4 121.1 52.6
                  120.7 53 120.3 53.4 120.1 53.9 120.1 54.5L120.1 64.2C120.1 65 120 65.8 119.7 66.6
                  119.3 67.3 118.9 68 118.3 68.5 117.8 69.1 117.1 69.5 116.4 69.9 115.6 70.2 114.8 70.3
                  114 70.3 113.1 70.3 112.3
                  70.2 111.6 69.9 110.8 69.5 110.2 69.1 109.6 68.5
                  109.1 68 108.6 67.3 108.3 66.6 108 65.8 107.8 65 107.8 64.2L107.8 54.5C107.8 53.9
                  107.6 53.4 107.2 53 106.8 52.6 106.4 52.4 105.8 52.4L105.8 52.4zM64.5 56.5C65.5 56.5
                  66.3 56.7 67.2 57.1 68 57.4 68.7 57.9 69.4 58.6
                  70 59.2 70.5 59.9 70.8 60.8 71.2 61.6 71.4 62.5 71.4 63.4 71.4 64.4 71.2 65.2 70.8
                  66.1 70.5 66.9 70 67.6 69.4 68.3 68.8 68.9 68 69.4 67.2 69.7 66.4 70.1 65.5 70.3 64.5
                  70.3 63.5 70.3 62.6 70.1
                  61.8 69.7 61 69.4 60.2 68.9 59.6 68.3 59 67.7 58.5 66.9 58.1 66.1 57.8 65.2 57.6
                  64.3 57.6 63.4 57.6 62.5 57.8 61.6 58.1 60.7 58.5 59.9 59 59.2 59.6 58.6 60.2 57.9
                  60.9 57.4 61.8 57.1 62.6 56.7 63.5 56.5 64.5 56.5zM15.2
                  57.1L15.2 57.1 15.2 63.6 15.2 63.7 20.6 67.4 21.2 66.5 16.2 63.2 16.2 57.1 15.2
                  57.1zM100.2 60.2L100.2 60.2C100.2 60.2 100.2 60.2 100.2 60.2L100.2
                  60.2zM100.2 60.2L99.6 63.4 96.4 62.3C96.5 62.7 96.5 63 96.5 63.4 96.5 64.4 96.4
                  65.2 96 66.1 95.6 66.9 95.2 67.6 94.5 68.3 93.9 68.9 93.2 69.4 92.3 69.8 91.5 70.1
                  90.6 70.3 89.7 70.3 88.7 70.3 87.8 70.1 86.9 69.8 86.6
                  69.6 86.2 69.4 85.9 69.2L88.4 68 84.6 66.4 80.9 64.7 79.8 68.7 78.8 72.7 81.9 71.2C81.9
                  71.2 81.9 71.2 81.9 71.2 84 73.3 86.6 74.4 89.7 74.4 92.7
                  74.4 95.3 73.3 97.4 71.2 99.6 69.1 100.6 66.5
                  100.6 63.4 100.6 62.3 100.5 61.2 100.2 60.2z"
                  fill="#fff"/>
          </svg>
        </a>
      </div>
      <div id="navbar" class="collapse navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li><a href="/">Home</a></li>
          <li><a href="/getting-started.html">Getting started</a></li>
          <li class="active"><a href="/documentation.html" class="active">Documentation</a></li>
          <li><a href="https://github.com/sebastianfeldmann/phpbu">GitHub</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-left"><li class="dropdown">
  <a aria-expanded="false" role="button" data-toggle="dropdown" class="dropdown-toggle" href="#">Versions <span class="caret"></span></a>
  <ul role="menu" class="dropdown-menu">
<li class="dropdown-header">6.0 (stable)</li><li><a href="../../6.0/en/index.html"><span class="flag en"></span>English</a></li>
<li class="divider"></li>
<li class="dropdown-header">5.2 (old stable)</li><li><a href="../../5.2/en/index.html"><span class="flag en"></span>English</a></li>
<li class="divider"></li>
<li class="dropdown-header">5.1 (unsupported)</li><li><a href="../../5.1/en/index.html"><span class="flag en"></span>English</a></li>
<li class="divider"></li>
<li class="dropdown-header">5.0 (unsupported)</li><li><a href="../../5.0/en/index.html"><span class="flag en"></span>English</a></li>
<li class="divider"></li>
<li class="dropdown-header">4.0 (unsupported)</li><li><a href="../../4.0/en/index.html"><span class="flag en"></span>English</a></li>
<li class="divider"></li>
<li class="dropdown-header">3.2 (unsupported)</li><li><a href="../../3.2/en/index.html"><span class="flag en"></span>English</a></li>
<li class="divider"></li>
<li class="dropdown-header">3.1 (unsupported)</li><li class="active"><a href="../../3.1/en/index.html"><span class="flag en"></span>English</a></li>
<li class="divider"></li>
<li class="dropdown-header">3.0 (unsupported)</li><li><a href="../../3.0/en/index.html"><span class="flag en"></span>English</a></li>
<li class="divider"></li>
<li class="dropdown-header">2.1 (unsupported)</li><li><a href="../../2.1/en/index.html"><span class="flag en"></span>English</a></li>
  </ul>
</li>
</ul>
      </div>
    </div>
  </nav>

  <div class="container">
    <div class="row">
      <div class="col-md-3">
        <div class="doc-sidebar hidden-print">
          <dl class="toc nav hidden-print"><dt><span class="chapter"><a href="installation.html">1. Installing PHPBU</a></span></dt><dd><dl><dt><span class="section"><a href="installation.html#installation.requirements">Requirements</a></span></dt><dt><span class="section"><a href="installation.html#installation.phar">PHP Archive (PHAR)</a></span></dt><dt><span class="section"><a href="installation.html#installation.composer">Composer</a></span></dt><dt><span class="section"><a href="installation.html#installation.integrations">Framework integrations</a></span></dt></dl></dd><dt><span class="chapter"><a href="configuration.html">2. Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="configuration.html#configuration.xml">XML-Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="configuration.html#configuration.xml.elements">List of tags</a></span></dt></dl></dd><dt><span class="section"><a href="configuration.html#configuration.json">JSON-Configuration</a></span></dt><dt><span class="section"><a href="configuration.html#configuration.schedule">Schedule backups</a></span></dt></dl></dd><dt><span class="chapter"><a href="cli.html">3. The Command-Line-Runner</a></span></dt><dd><dl><dt><span class="section"><a href="cli.html#cli.options">Command-Line-Runner options</a></span></dt><dt><span class="section"><a href="cli.html#cli.simulation">Simulation</a></span></dt></dl></dd><dt><span class="chapter"><a href="source.html">4. Backup Sources</a></span></dt><dd><dl><dt><span class="section"><a href="source.html#source.arangodump">ArangoDB</a></span></dt><dt><span class="section"><a href="source.html#source.mongodump">MongoDB</a></span></dt><dt><span class="section"><a href="source.html#source.mysqldump">MySQL - mysqldump</a></span></dt><dt><span class="section"><a href="source.html#source.xtrabackup">MySQL - xtrabackup</a></span></dt><dt><span class="section"><a href="source.html#source.pgdump">pgdump</a></span></dt><dt><span class="section"><a href="source.html#source.redis">redis</a></span></dt><dt><span class="section"><a href="source.html#source.tar">Directories</a></span></dt></dl></dd><dt><span class="chapter"><a href="check.html">5. Backup Validation</a></span></dt><dd><dl><dt><span class="section"><a href="check.html#check.sizemin">Minimal size</a></span></dt><dt><span class="section"><a href="check.html#check.sizediff">Compare to previous Backups</a></span></dt></dl></dd><dt><span class="chapter"><a href="crypt.html">6. Encryption</a></span></dt><dd><dl><dt><span class="section"><a href="crypt.html#crypt.mcrypt">mcrypt</a></span></dt><dt><span class="section"><a href="crypt.html#crypt.openssl">openssl</a></span></dt></dl></dd><dt><span class="chapter"><a href="sync.html">7. Sync Backups</a></span></dt><dd><dl><dt><span class="section"><a href="sync.html#sync.amazon">Amazon S3</a></span></dt><dt><span class="section"><a href="sync.html#sync.dropbox">Dropbox</a></span></dt><dt><span class="section"><a href="sync.html#sync.rsync">Rsync</a></span></dt><dt><span class="section"><a href="sync.html#sync.sftp">SFTP / FTP</a></span></dt><dt><span class="section"><a href="sync.html#sync.softlayer">Softlayer Object Storage</a></span></dt></dl></dd><dt><span class="chapter"><a href="cleanup.html">8. Cleanup backups</a></span></dt><dd><dl><dt><span class="section"><a href="cleanup.html#cleanup.capacity">Cleanup by capacity</a></span></dt><dt><span class="section"><a href="cleanup.html#cleanup.outdated">Cleanup by date</a></span></dt><dt><span class="section"><a href="cleanup.html#cleanup.quantity">Cleanup by quantity</a></span></dt></dl></dd><dt><span class="chapter"><a href="logging.html">9. Logging</a></span></dt><dd><dl><dt><span class="section"><a href="logging.html#logging.json">JSON</a></span></dt><dt><span class="section"><a href="logging.html#logging.email">E-Mail</a></span></dt></dl></dd><dt><span class="chapter"><a href="extending-phpbu.html" class="active">10. Extending PHPBU</a></span></dt><dd><dl><dt><span class="section"><a href="extending-phpbu.html#extending.simulation">Executing and simulating</a></span></dt><dt><span class="section"><a href="extending-phpbu.html#extending.source">Create a custom Source</a></span></dt><dt><span class="section"><a href="extending-phpbu.html#extending.check">Create a custom Check</a></span></dt><dt><span class="section"><a href="extending-phpbu.html#extending.sync">Create a custom Sync</a></span></dt><dt><span class="section"><a href="extending-phpbu.html#extending.cleaner">Create a custom Cleaner</a></span></dt><dt><span class="section"><a href="extending-phpbu.html#extending.logger">Create a custom Logger</a></span></dt><dt><span class="section"><a href="extending-phpbu.html#extending.summary">Summary</a></span></dt></dl></dd><dt><span class="chapter"><a href="integrations.html">11. Framework integrations</a></span></dt><dd><dl><dt><span class="section"><a href="integrations.html#integrations.laravel">Laravel</a></span></dt><dd><dl><dt><span class="section"><a href="integrations.html#integrations.laravel.installation">Installation</a></span></dt><dt><span class="section"><a href="integrations.html#integrations.laravel.configuration">Configuration</a></span></dt><dt><span class="section"><a href="integrations.html#integrations.laravel.usage">Usage</a></span></dt></dl></dd></dl></dd><dt><span class="appendix"><a href="appendixes.index.html">A. Index</a></span></dt><dd><dl><dt><span class="index"><a href="appendixes.index.html#appendixes.index.index"></a></span></dt></dl></dd><dt><span class="appendix"><a href="appendixes.copyright.html">B. Copyright</a></span></dt></dl>
        </div>
      </div>
      <div class="col-md-9">
        <div class="row">
          <div class="col-md-1 pull-left prev"><a accesskey="p" href="logging.html">Prev</a></div>
          <div class="col-md-1 pull-right next"><a accesskey="n" href="integrations.html">Next</a></div>
        </div>
        <div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="extending-phpbu"></a>Chapter 10. Extending PHPBU</h1></div></div></div><a id="id2971" class="indexterm"></a><p>
    You can extend PHPBU with your own Source, Check, Crypt, Sync, Cleanup and Logger implementations.
  </p><p>
    All you have to do is to register your implementation at the PHPBU Factory.
    You can do this by adding you own bootstrap file.
  </p><pre class="screen"><strong class="userinput"><code>phpbu --bootstrap=extend.php</code></strong></pre><p>Your extend.php file could look something like this:</p><div class="example"><a id="id2979"></a><p class="title"><strong>Example 10.1: Extend bootstrap</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
  // make your class accessible
  require 'Acme/MySource.php';
  // register your class as a source
  try {
      phpbu\App\Factory::register('source', 'mysource', '\\Acme\\MySource');
  } catch (Exception $e) {
      die($e-&gt;getMessage());
  }</pre></div></div><br class="example-break"></br><p>
    For this to work your class Acme\MySource hast to implement
    the <code class="literal">phpbu\App\Backup\Source</code> Interface.
    After registering your Source you can use <code class="literal">mysource</code> as source-type
    within your XML configuration like this.
  </p><div class="example"><a id="id2985"></a><p class="title"><strong>Example 10.2: Custom Source XML example</strong></p><div class="example-contents"><pre class="programlisting">&lt;source type="mysource"&gt;&lt;/source&gt;</pre></div></div><br class="example-break"></br><p>
    If the alias is already taken this will throw an Exception.
    You can force phpbu to overwrite any previously registered class using the $force Parameter.
    Even the phpbu sources could be replaced with custom implementations.
  </p><div class="example"><a id="id2989"></a><p class="title"><strong>Example 10.3: Overwrite default sources</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
// make your class accessible
require 'Acme/MyMysqldump.php';
// register your class as source, override already registered class
phpbu\App\Factory::register('source', 'mysqldump', '\\Acme\\MyMysqldump', true);</pre></div></div><br class="example-break"></br><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending.simulation"></a>Executing and simulating</h2></div></div></div><p>
      If you are extending phpbu you have two options. The first is to simply implement the execution interface. This way
      you can execute your own Source, Check, Crypt, Sync or Cleanup tasks. The second option is to implement the
      respective <code class="literal">Simulator</code> interface. Choosing this option you not only have to implement the execution
      part but rather implement a simulation part as well.
    </p><p>
      Simulation is supported out of the box for every implementation, but choosing option two enables you to add
      viable information about the actions you perform in your code within a simulation run.
    </p><div class="table"><a id="extending-phpbu.tables.available-interfaces"></a><p class="title"><strong>Table 10.1. Types to register:</strong></p><div class="table-contents"><table class="table table-striped" summary="Types to register:"><colgroup><col></col><col></col><col></col></colgroup><thead><tr><th align="left">Type</th><th align="left">Interface for execution only</th><th align="left">Interface for execution and simulation</th></tr></thead><tbody><tr><td align="left">source</td><td align="left">phpbu\App\Backup\Source</td><td align="left">phpbu\App\Backup\Source\Simulator</td></tr><tr><td align="left">check</td><td align="left">phpbu\App\Backup\Check</td><td align="left">phpbu\App\Backup\Check\Simulator</td></tr><tr><td align="left">crypt</td><td align="left">phpbu\App\Backup\Crypt</td><td align="left">phpbu\App\Backup\Crypt</td></tr><tr><td align="left">sync</td><td align="left">phpbu\App\Backup\Sync</td><td align="left">phpbu\App\Backup\Sync\Simulator</td></tr><tr><td align="left">cleanup</td><td align="left">phpbu\App\Backup\Cleanup</td><td align="left">phpbu\App\Backup\Cleanup\Simulator</td></tr><tr><td align="left">logger</td><td align="left">phpbu\App\Backup\Logger</td><td align="left">-</td></tr></tbody></table></div></div><br class="table-break"></br></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending.source"></a>Create a custom Source</h2></div></div></div><p>
      A minimal custom Source class could look like this.
    </p><div class="example"><a id="id3033"></a><p class="title"><strong>Example 10.4: Create a custom source</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
namespace Acme;

use \phpbu\App\Backup\Result;
use \phpbu\App\Backup\Source;
use \phpbu\App\Backup\Target;

class MySource implements Source
{
    /**
     * Some data that has to be configured.
     */
    private $someConfigValue;

    /**
     * Here you should validate the configuration and setup your class.
     *
     * @param array $conf
     */
    public function setup(array $conf)
    {
        // here you are getting all of your configured options
        // $conf[ &lt;option name&gt; ] = &lt;option value&gt;
        $this-&gt;someConfigValue = $conf['foo']
    }

    /**
     * In here you should create your backup.
     *
     * @return \phpub\App\Backup\Source\Status
     * @throws \phpbu\App\Backup\Source\Exception
     */
    public function backup(Target $target, Result $result)
    {
        // use these methods to store the backup at the configured location
        // $target-&gt;getPath()
        // $target-&gt;getPathname()
        // $target-&gt;getFilename()
        // to know if the backup should be compressed use
        // $target-&gt;shouldBeCompressed()
        // to get the compression settings use
        // $target-&gt;getCompressor()
        // if you want to log some debug information use
        // $result-&gt;debug('some message');
        // anything bad happens throw a \phpbu\App\Exception
        // return a backup status
        // this is important so the runner knows if it still has to compress the backup
        // return Status::create()-&gt;uncompressed($pathToUncompressedFile);
    }
}</pre></div></div><br class="example-break"></br></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending.check"></a>Create a custom Check</h2></div></div></div><p>
      Custom Check implementation example.
    </p><div class="example"><a id="id3039"></a><p class="title"><strong>Example 10.5: Create a custom check</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
namespace Acme;

use \phpbu\App\Backup\Check;
use \phpbu\App\Backup\Collector;
use \phpbu\App\Backup\Target;

class MyCheck implements Check
{
    /**
     * Perform your check.
     */
    public function pass(Target $target, $value, Collector $collector)
    {
        // use Target to refer to the created backup
        // $target-&gt;getPathname()
        // $value is the configured value
        // &lt;check type="mycheck" value="myvalue"/&gt;
        // $value = "myvalue"
        // use the collector to get a list of previous backups array&lt;splFileInfo&gt;
        // $history = $collector-&gt;getBackups()
        // throw a \phpbu\App\Backup\Check\Exception if something bad is happening
        // finally return if the check passes or not
        return $boolean;
    }
}</pre></div></div><br class="example-break"></br></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending.sync"></a>Create a custom Sync</h2></div></div></div><p>
      Implementing a custom Sync.
    </p><div class="example"><a id="id3045"></a><p class="title"><strong>Example 10.6: Create a custom sync</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
namespace Acme;

use \phpbu\App\Backup\Sync;
use \phpbu\App\Backup\Target;

class MySync implements Sync
{
    /**
     * Some data that has to be configured.
     */
    private $someConfigValue;

    /**
     * Here you should validate the configuration and setup your class.
     */
    public function setup(array $conf)
    {
        // here you are getting all of your configured options
        // $conf[ &lt;option name&gt; ] = &lt;option value&gt;
        $this-&gt;someConfigValue = $conf['foo']
    }

    /**
     * Execute your sync.
     */
    public function sync(Target $target, Result $result)
    {
        // use Target to refer to the created backup
        // $target-&gt;getPathname()
        // execute your sync
        // if you want to log some debug information use
        // $result-&gt;debug('some message');
        // throw a \phpbu\App\Backup\Sync\Exception if something is going wrong
    }
}</pre></div></div><br class="example-break"></br></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending.cleaner"></a>Create a custom Cleaner</h2></div></div></div><p>
        Implementing a custom cleaner.
      </p><div class="example"><a id="id3051"></a><p class="title"><strong>Example 10.7: Create a custom cleaner</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
namespace Acme;

use \phpbu\App\Backup\Collector;
use \phpbu\App\Backup\Sync;
use \phpbu\App\Backup\Target;

class MyCleaner implements Sync
{
    /**
     * Some data that has to be configured.
     */
    private $someConfigValue;

    /**
     * Here you should validate the configuration and setup your class.
     */
    public function setup(array $conf)
    {
        // here you are getting all of your configured options
        // $conf[ &lt;option name&gt; ] = &lt;option value&gt;
        $this-&gt;someConfigValue = $conf['foo']
    }

    /**
     * Execute your cleanup.
     */
    public function cleanup(Target $target, Collector $collector, Result $result)
    {
        // use Target to refer to the created backup
        // $target-&gt;getPathname()
        // use the collector to get a list of previous backups array&lt;splFileInfo&gt;
        // delete files matching your cleanup rules
        // $history = $collector-&gt;getBackups()
        // if you want to log some debug information use
        // $result-&gt;debug('some message');
        // throw a \phpbu\App\Backup\Cleaner\Exception if something is going wrong
    }
}</pre></div></div><br class="example-break"></br></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending.logger"></a>Create a custom Logger</h2></div></div></div><div class="itemizedlist"><p class="title"><strong>List of available events:</strong></p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>phpbu.debug</p></li><li class="listitem"><p>phpbu.app_start</p></li><li class="listitem"><p>phpbu.app_end</p></li><li class="listitem"><p>phpbu.backup_start</p></li><li class="listitem"><p>phpbu.backup_failed</p></li><li class="listitem"><p>phpbu.backup_end</p></li><li class="listitem"><p>phpbu.crypt_start</p></li><li class="listitem"><p>phpbu.crypt_failed</p></li><li class="listitem"><p>phpbu.crypt_end</p></li><li class="listitem"><p>phpbu.check_start</p></li><li class="listitem"><p>phpbu.check_failed</p></li><li class="listitem"><p>phpbu.check_end</p></li><li class="listitem"><p>phpbu.sync_start</p></li><li class="listitem"><p>phpbu.sync_failed</p></li><li class="listitem"><p>phpbu.sync_skipped</p></li><li class="listitem"><p>phpbu.sync_end</p></li><li class="listitem"><p>phpbu.cleanup_start</p></li><li class="listitem"><p>phpbu.cleanup_failed</p></li><li class="listitem"><p>phpbu.cleanup_skipped</p></li><li class="listitem"><p>phpbu.cleanup_end</p></li></ul></div><p>
      Implementing a custom logger.
    </p><div class="example"><a id="id3099"></a><p class="title"><strong>Example 10.8: Create a custom logger</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
namespace Acme;

use phpbu\App\Event;
use phpbu\App\Log\Logger;

class MyLogger implements Logger
{
    /**
     * Logger interface requires 'getSubscribedEvents' method.
     * Define the events you want to get notified about.
     */
    public static function getSubscribedEvents()
    {
        return array(
            'phpbu.debug'   =&gt; 'onDebug',
            'phpbu.app_end' =&gt; 'onPhpbuEnd',
        );
    }

    /**
     * Logger interface requires 'setup' method to configure your logger.
     * Here you should validate the configuration and setup your class.
     */
    public function setup(array $conf)
    {
        // here you are getting all of your configured options
        // $conf[ &lt;option name&gt; ] = &lt;option value&gt;
    }

    /**
     * Handle the debug event.
     */
    public function onDebug(Event\Debug $event)
    {
        // use $event-&gt;getMessage() to get the debug message
    }

    /**
     * Handle phpbuEnd event
     */
    public function onPhpbuEnd(Event\App\End $event)
    {
        // handle the phpbuEnd
        // use $event-&gt;getResult() to get the application result
    }
}</pre></div></div><br class="example-break"></br></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending.summary"></a>Summary</h2></div></div></div><div class="example"><a id="id3104"></a><p class="title"><strong>Example 10.9: Example file structure</strong></p><div class="example-contents"><pre class="programlisting">acme/
├── backup/
├── src/
|  ├── bootstrap.php
|  ├── MyCheck.php
|  ├── MyCleaner.php
|  ├── MyCrypt.php
|  ├── MySource.php
|  └── MySync.php
|
├── phpbu.phar
└── phpbu.xml.dist</pre></div></div><br class="example-break"></br><div class="example"><a id="id3107"></a><p class="title"><strong>Example 10.10: Example bootstrap.php</strong></p><div class="example-contents"><pre class="programlisting">&lt;?php
// use your autoloader or require your classes manually
// so phpbu can find them while executing you backup
// register your class as source, you may override already registered classes
phpbu\App\Factory::register('source', 'mysource', '\\Acme\\MySource');
phpbu\App\Factory::register('check', 'mycheck', '\\Acme\\MyCheck');
phpbu\App\Factory::register('cleanup', 'mycleanup', '\\Acme\\MyCleaner');</pre></div></div><br class="example-break"></br><div class="example"><a id="id3110"></a><p class="title"><strong>Example 10.11: Example phpbu.xml.dist</strong></p><div class="example-contents"><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;phpbu xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="http://schema.phpbu.de/3.1/phpbu.xsd"&gt;
  &lt;backups&gt;
    &lt;backup&gt;
      &lt;!-- source --&gt;
      &lt;source type="mysource"&gt;
        &lt;option name="foo" value="bar"/&gt;
      &lt;/source&gt;
      &lt;!-- where should the backup be stored --&gt;
      &lt;target dirname="backup"
              filename="mysource-%Y%m%d-%H%i.backup"
              compress="bzip2"/&gt;
      &lt;!-- check the created backup --&gt;
      &lt;check type="mycheck" value="100"/&gt;
      &lt;!-- cleanup the backup location --&gt;
      &lt;cleanup type="mycleanup"&gt;
        &lt;option name="foo" value="bar"/&gt;
      &lt;/cleanup&gt;
    &lt;/backup&gt;
  &lt;/backups&gt;
&lt;/phpbu&gt;</pre></div></div><br class="example-break"></br></div></div>
        <div class="row">
          <div class="col-md-1 pull-left prev"><a accesskey="p" href="logging.html">Prev</a></div>
          <div class="col-md-1 pull-right next"><a accesskey="n" href="integrations.html">Next</a></div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <div class="alert alert-info improve">Please <a href="https://github.com/sebastianfeldmann/phpbu-documentation/issues">open a ticket</a> on GitHub to suggest improvements to this page. Thanks!</div>
      </div>
    </div>
  </div>
  <div class="container">
    <hr/>
    <footer id="footer" class="clearfix">
      <p class="copyright"><a href="appendixes.copyright.html">Copyright</a> &copy; 2014 - 2019 Sebastian Feldmann.</p>
      <p class="social"><a href="https://twitter.com/phpbude" class="twitter" title="follow on twitter">follow on twitter</a></p>
    </footer>
  </div>

  <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/highlight.min.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $('pre.programlisting').each(function(i, e) {hljs.highlightBlock(e)});
    });

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-59194092-1', 'auto');
    ga('send', 'pageview');
  </script>
 </body>
</html>
